name = "knowledge-search-app"
main = "./src/worker/index.ts"
compatibility_date = "2025-01-30"
compatibility_flags = ["nodejs_compat"]

[observability]
enabled = true

[assets]
directory = "dist/client"
not_found_handling = "single-page-application"

[[d1_databases]]
binding = "DB"
database_name = "knowledge-search-db"
database_id = "1db6219f-6f57-4afb-9db3-3b7520f052d6"

# Capitão Caverna Image Engine D1 Database
# Note: This database needs to be created in Cloudflare dashboard
# [[d1_databases]]
# binding = "IMAGE_DB"
# database_name = "capitao-caverna-images-db"
# database_id = "your-image-db-uuid-here"

# Capitão Caverna Image Storage R2 Bucket
# Note: This bucket needs to be created in Cloudflare dashboard
# [[r2_buckets]]
# binding = "IMAGE_BUCKET"
# bucket_name = "capitao-caverna-images"

[vars]
# Environment configuration
ENVIRONMENT = "development"
MAX_REQUESTS_PER_MINUTE = "10"
OPENAI_MODEL = "gpt-4o-mini"
OPENAI_MAX_TOKENS = "600"
OPENAI_TEMPERATURE = "0.3"

# Rate limiting configuration
RATE_LIMIT_WINDOW_SECONDS = "60"
RATE_LIMIT_MAX_REQUESTS = "10"

# Add your environment variables here
# OPENAI_API_KEY = "your-openai-api-key-here"
# MINIO_ENDPOINT = "s3.centralcaverna.com"
# MINIO_ACCESS_KEY = "cavernacentral"
# MINIO_SECRET_KEY = "Qwertyytrewq1773@"
# GOOGLE_CLIENT_ID = "your-google-client-id"
# GOOGLE_CLIENT_SECRET = "your-google-client-secret"

# Capitão Caverna Image Engine - External AI Services
# MIDJOURNEY_API_KEY = "your-midjourney-api-key"
# DALLE_API_KEY = "your-dalle-api-key"
# STABLE_DIFFUSION_API_KEY = "your-stable-diffusion-api-key"
# IMAGE_GENERATION_SERVICE = "midjourney" # Options: midjourney, dalle, stable-diffusion

# KV Namespace for rate limiting
[[kv_namespaces]]
binding = "KV"
id = "8417409bb561463bab1ebb667bf4f439"
preview_id = "3fa2a4157a784408b27c3d36d8979a74"